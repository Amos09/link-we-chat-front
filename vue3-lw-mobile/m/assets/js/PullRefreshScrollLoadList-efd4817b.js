import{_ as e}from"../index-b355da82.js";import{D as t,E as s,G as i,r,J as a,O as o,I as n,F as u,H as l,P as d,t as h,Q as p}from"./_@vue_runtime-core@3.3.11@@vue-724baf7c.js";import{L as m}from"./_@vue_shared@3.3.11@@vue-c40e50ba.js";/* empty css                                           */import"./_@vue_runtime-dom@3.3.11@@vue-75e0886e.js";import"./_pinia@2.1.7@pinia-1508863f.js";import"./_vue-demi@0.14.6@vue-demi-71ba0ef2.js";import"./_@vue_reactivity@3.3.11@@vue-4dc2fb75.js";import"./_vue-router@4.2.5@vue-router-79fdc450.js";import"./_vant@4.8.0@vant-38f95c08.js";import"./_@vant_use@1.6.0@@vant-ee63bb3a.js";import"./_@vant_popperjs@1.3.0@@vant-afbd2e22.js";import"./_@vueuse_core@10.7.0@@vueuse-c5c5b2cd.js";import"./_@vueuse_shared@10.7.0@@vueuse-12ca11fe.js";import"./_vconsole@3.15.1@vconsole-24c60b35.js";const f={name:"",props:{request:{type:Function},isQuery:{type:Boolean,default:!0},params:{type:Object,default:()=>({})},dealQueryFun:{type:Function,default:null},dealDataFun:{type:Function,default:null}},data:()=>({loading:!1,query:{pageNum:1,pageSize:10,type:""},refreshing:!1,finished:!1,finishedText:"",error:!1,list:[]}),computed:{},watch:{},created(){this.getList(1)},mounted(){},methods:{getList(e){this.loading=!0,this.finished=!1,e&&(this.query.pageNum=e),Object.assign(this.query,this.params),this.dealQueryFun&&this.dealQueryFun(this.query),this.request(this.query).then((({rows:e,data:t,total:s=0})=>{e??(e=t||[]),1==this.query.pageNum&&(this.list=[]),this.dealDataFun&&this.dealDataFun(e),this.list.push(...e),this.loading=!1,this.refreshing=!1,this.list.length>=+s?(0==this.list.length?(this.query.pageNum=1,this.finishedText=""):this.finishedText="没有更多了",this.finished=!0):this.query.pageNum++})).catch((e=>{this.error=!0,this.loading=!1,this.finished=!0}))}}},c={class:"PullRefreshScrollLoadList"},v={key:0,class:"query g-margin-b"};const g=e(f,[["render",function(e,f,g,y,_,j){const q=t("van-button"),x=t("van-field"),F=t("Empty"),L=t("van-list"),b=t("van-pull-refresh");return s(),i("div",c,[g.isQuery?(s(),i("div",v,[r(x,{modelValue:_.query.keywords,"onUpdate:modelValue":f[1]||(f[1]=e=>_.query.keywords=e),placeholder:"请输入关键词",clearable:""},{button:a((()=>[r(q,{icon:"search",onClick:f[0]||(f[0]=e=>j.getList(1))})])),_:1},8,["modelValue"])])):o("",!0),r(b,{modelValue:_.refreshing,"onUpdate:modelValue":f[5]||(f[5]=e=>_.refreshing=e),"success-text":"刷新成功",onRefresh:f[6]||(f[6]=e=>j.getList(1))},{default:a((()=>[r(L,{loading:_.loading,"onUpdate:loading":f[2]||(f[2]=e=>_.loading=e),finished:_.finished,"finished-text":_.finishedText,error:_.error,"onUpdate:error":f[3]||(f[3]=e=>_.error=e),"error-text":"请求失败，点击重新加载",onLoad:f[4]||(f[4]=e=>j.getList())},{default:a((()=>[_.error||_.loading||_.list&&_.list.length?o("",!0):(s(),n(F,{key:0})),(s(!0),i(u,null,l(_.list,((t,s)=>d(e.$slots,"item",m(h({key:s},{item:t})),void 0,!0))),128)),d(e.$slots,"list",m(p({list:_.list})),void 0,!0)])),_:3},8,["loading","finished","finished-text","error"])])),_:3},8,["modelValue"])])}],["__scopeId","data-v-2efe5fc7"]]);export{g as default};
