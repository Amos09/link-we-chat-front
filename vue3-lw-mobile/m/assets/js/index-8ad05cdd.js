import{r as e,_ as s}from"../index-b355da82.js";import{a,b as r,h as t,i as o}from"./_vant@4.8.0@vant-38f95c08.js";import{a as i,r as u,u as n,i as l}from"./_@vue_reactivity@3.3.11@@vue-4dc2fb75.js";import{c as d,D as m,E as p,G as c,M as v,r as _,J as g,x as f,K as h,L as w}from"./_@vue_runtime-core@3.3.11@@vue-724baf7c.js";/* empty css                                           */import"./_@vue_runtime-dom@3.3.11@@vue-75e0886e.js";import"./_@vue_shared@3.3.11@@vue-c40e50ba.js";import"./_pinia@2.1.7@pinia-1508863f.js";import"./_vue-demi@0.14.6@vue-demi-71ba0ef2.js";import"./_vue-router@4.2.5@vue-router-79fdc450.js";import"./_@vueuse_core@10.7.0@@vueuse-c5c5b2cd.js";import"./_@vueuse_shared@10.7.0@@vueuse-12ca11fe.js";import"./_vconsole@3.15.1@vconsole-24c60b35.js";import"./_@vant_use@1.6.0@@vant-ee63bb3a.js";import"./_@vant_popperjs@1.3.0@@vant-afbd2e22.js";const{get:y,post:b}=e;const j=e=>(h("data-v-a3900579"),e=e(),w(),e),x={class:"page"},N=[j((()=>v("div",{class:"card-title"},"专员服务",-1))),j((()=>v("div",{class:"card-text"},"发送专员名片邀请",-1)))],k=[j((()=>v("div",{class:"card-title"},"专群服务",-1))),j((()=>v("div",{class:"card-text"},"发送专群加入邀请",-1)))],C={class:"footer flex",style:{margin:"20px"}},L=s({__name:"index",setup(e){let s={},h=i({type:"user",show:!1}),w=u(!1),j=i(JSON.parse(JSON.stringify(s))),L=i({});function I(e){h.type=e,"user"==e&&L.userList||"group"==e&&L.groupList?h.show=!0:a({title:"提示",message:"暂未配置服务专群，需联系管理员在企微后台进行配置。"})}y("/kf/get/upgrade/service/config").then((({data:e})=>{L.userList=e.userList,L.groupList=e.groupList}));let G=d((()=>{var e,s;return"user"==h.type?null==(e=L.userList)?void 0:e.map((e=>({name:e.userName,id:e.weUserId}))):null==(s=L.groupList)?void 0:s.map((e=>({name:e.name,id:e.chatId})))}));function J({selectedOptions:e}){j._memberGroupId=e[0].id,j._memberGroupName=e[0].name,w.value=!1}function O(){const e=r(),a=JSON.parse(JSON.stringify(j));wx.invoke("getCurExternalContact",{},(function(r){var u;"getCurExternalContact:ok"==r.err_msg?(a.external_userid=r.userId,"user"==h.type?(a.type=1,a.member={userid:j._memberGroupId,wording:j.wording}):(a.type=0,a.groupchat={chat_id:j._memberGroupId,wording:j.wording}),(u=a,b("/kf/upgrade/service",u)).then((e=>{h.show=!1,t("操作成功"),j=i(JSON.parse(JSON.stringify(s)))})).finally((()=>{e.close()}))):(e.close(),o("获取外部联系人userId失败"))}))}return(e,s)=>{const a=m("van-field"),r=m("van-picker"),t=m("van-popup"),o=m("van-button"),i=m("van-form"),u=m("van-action-sheet");return p(),c("div",x,[v("div",{class:"card",onClick:s[0]||(s[0]=e=>I("user"))},N),v("div",{class:"card",onClick:s[1]||(s[1]=e=>I("group"))},k),_(u,{show:n(h).show,"onUpdate:show":s[7]||(s[7]=e=>n(h).show=e),title:("user"==n(h).type?"专员":"专群")+"服务"},{default:g((()=>[_(i,{onSubmit:O},{default:g((()=>[_(a,{modelValue:n(j)._memberGroupName,"onUpdate:modelValue":s[2]||(s[2]=e=>n(j)._memberGroupName=e),modelModifiers:{trim:!0},readonly:"",required:"",label:"选择"+("user"==n(h).type?"专员":"专群"),placeholder:"请选择",onClick:s[3]||(s[3]=e=>l(w)?w.value=!0:w=!0)},null,8,["modelValue","label"]),_(t,{show:n(w),"onUpdate:show":s[5]||(s[5]=e=>l(w)?w.value=e:w=e),round:"",position:"bottom"},{default:g((()=>[_(r,{title:"请选择","columns-field-names":{text:"name",value:"id"},"show-toolbar":"",columns:n(G),onCancel:s[4]||(s[4]=e=>l(w)?w.value=!1:w=!1),onConfirm:J},null,8,["columns"])])),_:1},8,["show"]),_(a,{modelValue:n(j).wording,"onUpdate:modelValue":s[6]||(s[6]=e=>n(j).wording=e),type:"textarea",rows:"6",required:"",autosize:"",label:"邀请语",placeholder:"请输入",maxlength:"100","show-word-limit":""},null,8,["modelValue"]),v("div",C,[_(o,{type:"primary","native-type":"submit",round:"",block:"",class:""},{default:g((()=>[f("确定升级")])),_:1})])])),_:1})])),_:1},8,["show","title"])])}}},[["__scopeId","data-v-a3900579"]]);export{L as default};
